<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë°ì´í„° ì „ì†¡ ì˜ˆì œ</title>
  <style>
    #loadingSpinner {
      display: none;
    }
    #loadingSpinner.active {
      display: inline-block;
    }
  </style>
</head>
<body>

  <h2>ë°ì´í„° ì „ì†¡ í…ŒìŠ¤íŠ¸</h2>
  <button onclick="submitData()">ë°ì´í„° ì „ì†¡</button>
  <div id="loadingSpinner">ë¡œë”© ì¤‘...</div>
  <div id="resultMessage"></div>

  <script>
    let submissionAllowed = true;

    async function submitData() {
      if (!submissionAllowed) {
        alert('ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        return;
      }

      submissionAllowed = false;
      setTimeout(() => { submissionAllowed = true; }, 3000);
      document.getElementById('loadingSpinner').classList.add('active');

      const gameData = {
        groupName: '1',
        roundName: '2',
        teamName: '3',
        bidAmount: '4',
        betting: '5'
      };

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbxNvq-jOIJDYvQwbaTOBXVhgx6Xjy2WO5_YEhofKOmabN-Rfg4OAqV0Aj3K7xgkOdw3/exec", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(gameData),
          mode: "cors"  // ğŸ”¸ CORS í—ˆìš© ëª…ì‹œ
        });

        if (!response.ok) {
          throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
        }

        const resultText = await response.text();
        onSuccess(resultText);

      } catch (error) {
        console.error("Fetch ì‹¤íŒ¨:", error); // ì½˜ì†” ì¶œë ¥ ì¶”ê°€
        onFailure(error);
      }
    }

    function onSuccess(message) {
      document.getElementById('loadingSpinner').classList.remove('active');
      document.getElementById('resultMessage').textContent = `ì„±ê³µ: ${message}`;
    }

    function onFailure(error) {
      document.getElementById('loadingSpinner').classList.remove('active');
      document.getElementById('resultMessage').textContent = `ì‹¤íŒ¨: ${error.message}`;
    }
  </script>

</body>
</html>
